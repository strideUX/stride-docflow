schema: checks.v1
id: agent-checks
version: 1
checks:
  - id: one-current-iteration
    title: Ensure exactly one current iteration folder exists
    severity: error
    applies_to: [docflow/iterations]
    description: There must be a single docflow/iterations/current/ folder.
    fix: false
  - id: iteration-router-links
    title: Iteration index has router links
    severity: warn
    applies_to: [docflow/iterations/current/index.md]
    description: Index must link to focus, session, worklist, backlog, decisions, inbox.
    fix: true
  - id: worklist-summary-matches
    title: Worklist summary matches item counts
    severity: warn
    applies_to: [docflow/iterations/current/features.md]
    description: summary totals should equal computed counts of items by status/priority.
    fix: true
  - id: allowed-status-flow
    title: Items use only allowed statuses
    severity: error
    applies_to: [docflow/iterations/current/features.md]
    description: Only pending, in_progress, in_review, completed are allowed.
    fix: true
  - id: dependencies-exist
    title: Dependencies reference existing items
    severity: error
    applies_to: [docflow/**]
    description: dependencies must reference existing F/C/B/S IDs; ADRs as links only.
    fix: false
  - id: spike-conclusion-followups
    title: Concluded spikes have follow ups
    severity: warn
    applies_to: [docflow/spikes/**]
    description: Spikes with state concluded must include non-empty follow_ups.
    fix: false
  - id: inbox-triage-cadence
    title: Inbox triaged recently
    severity: warn
    applies_to: [docflow/inbox/capture.md]
    description: Inbox should show recent activity; consider triage if stale.
    fix: false
  - id: worklist-peritem-sync
    title: Per-item files mirror worklist status
    severity: warn
    applies_to: [docflow/items/**, docflow/bugs/**, docflow/spikes/**]
    description: If a per-item file status differs from the worklist entry, sync to the worklist (source of truth).
    fix: false
